// 在 connectWebSocket 函数中修改：
function connectWebSocket() {
    // 自动检测服务器地址
    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
    const host = window.location.host;
    const serverUrl = `${protocol}//${host}/api/game`;
    
    try {
        ws = new WebSocket(serverUrl);
        
        ws.onopen = function() {
            console.log('已连接到服务器');
            updateConnectionStatus(true);
            reconnectAttempts = 0;
        };
        
        // 其余代码保持不变...
    } catch (error) {
        console.error('连接失败:', error);
        showMessage("无法连接到服务器，请检查网络连接");
    }
}